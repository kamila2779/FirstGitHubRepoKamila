homeDetailsContentJsonp([26],{1471:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n.n(r),i=n(48),o=n(7),s=n(25),l=n(1),c=(n.n(l),n(4)),u=n(16),d=n(19),m=n(11),p=n(132),v=n.n(p),f=n(27),g=n.n(f),h=n(35),E=n(66),b=n.n(E);function y(){var e=Object(s.a)(["\n    :hover {\n        background: ",";\n        color: ",";\n    }\n    cursor: pointer;\n"]);return y=function(){return e},e}var w=function(e){function t(t){var n;(n=e.call(this,t)||this).setActive=function(){n.state.isActive||n.setState({isActive:!0})},n.setInactive=function(){n.state.isActive&&n.setState({isActive:!1})},n.textChange=function(e){var t=g()(e,"target.value","")||"";n.setState({input:t})},n.onItemClick=function(e){var t=n.props.onSelect;n.setState({input:e},n.setInactive),t&&t(e)},n.getPopover=function(){var e=n.state.input,t=n.props.popOverTitle,r=void 0===t?null:t,i=e.length?e:".*",o=new RegExp(i,"i"),s=n.keys.filter((function(e){return o.test(e)}));return a.a.createElement(u.Popover,{shouldTakeFocus:!1,header:r?a.a.createElement("h3",null,r):null,body:a.a.createElement(z,{listItems:s,onClick:n.onItemClick})})};var r=t.data,i=void 0===r?{}:r;return n.keys=Object.keys(i),n.state={isActive:!1,input:""},n.inputRef=null,n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this.props.data,n=void 0===t?{}:t;e.data!==n&&(this.keys=Object.keys(n))},n.render=function(){var e=this.state,t=e.isActive,n=e.input;return a.a.createElement(u.Popper,{triggered:this.getPopover(),isOpenPropName:"isOpen",isOpen:t,placement:"bottom"},a.a.createElement(u.Input,{spacingTop:"sm",value:n.length||t?n:"Search for a version",onFocus:this.setActive,onBlur:this.setInactive,onChange:this.textChange}))},t}(a.a.PureComponent);w.propTypes={};var S=c.default.div.withConfig({componentId:"sc-158zrld-0"})(y(),(function(e){return e.theme.foundation.colors.brand}),(function(e){return e.theme.foundation.colors.white}));function z(e){var t=e.onClick,n=e.listItems;return a.a.createElement(r.Fragment,null,n.map((function(e){return a.a.createElement(S,{key:e,onClick:function(){return t(e)}},e)})))}function C(){var e=Object(s.a)(["\n    border-bottom: 1px solid ",";\n"]);return C=function(){return e},e}function k(){var e=Object(s.a)(["\n    background-color: ",";\n    ","\n    margin-top: ",";\n"]);return k=function(){return e},e}function N(){var e=Object(s.a)(["\n    padding-top: ",";\n    background-color: ",";\n"]);return N=function(){return e},e}z.propTypes={},z.defaultProps={onClick:function(){},listItems:[]};var P=c.default.div.withConfig({componentId:"sc-158zrld-1"})(N(),(function(e){return e.theme.foundation.spacing.sm()}),(function(e){return e.theme.foundation.colors.caution})),O=c.default.div.withConfig({componentId:"sc-158zrld-2"})(k(),(function(e){return e.theme.foundation.colors.white}),(function(e){return e.theme.hdp.util.padding}),(function(e){return e.theme.foundation.spacing.sm()})),T=c.default.h3.withConfig({componentId:"sc-158zrld-3"})(C(),(function(e){return e.theme.foundation.colors.yellow200})),I="hdpOverrideVersion",V=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleSelect=function(e){return new Promise((function(t,r){var a,i,o,s,l,c,u;if(a=n.props.zguid,i=n.state.versions,o=n.getArtifactString(),!(a&&i&&o&&void 0!==i[e]))return n.setErrorStatus("Unable to set override for zguid: "+a+", artifact: "+o+", version: "+e),p.call(this);l=(s=i[e]).resourceIdentifier,c=s.status;var d=(function(){try{return p.call(this)}catch(e){return r(e)}}).bind(this),m=function(t){try{return n.setErrorStatus("Unable to select artifact: "+o+", version: "+e),d()}catch(e){return r(e)}};try{return Promise.resolve(v.a.post("/admin/versions/overrides/",{key:a,artifacts:(u={},u[o]={versionName:e,resourceIdentifier:l,status:c},u)})).then((function(t){try{return n.setState({selectedVersion:e}),d()}catch(e){return m()}}),m)}catch(e){m()}function p(){return t()}}))},n.deleteOverride=function(){return new Promise((function(e,t){var r;if(r=n.props.zguid){var a=(function(){try{return o.call(this)}catch(e){return t(e)}}).bind(this),i=function(e){try{return n.setErrorStatus("Unable to undo override for zguid: "+r),a()}catch(e){return t(e)}};try{return Promise.resolve(v.a.delete("/admin/versions/overrides/",{params:{key:r}})).then((function(e){try{return n.refreshPage(),a()}catch(e){return i()}}),i)}catch(e){i()}}function o(){return e()}return o.call(this)}))},n.copyVersion=function(e){var t=e.split(".");if(t&&t.length){var r=t[t.length-1];navigator&&navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(window.location.host+window.location.pathname+"?"+I+"="+r).then((function(){n.setState({isCopied:!0})})).catch((function(){n.setState({copyError:!0})})):n.setState({copyError:!0})}},n.state={versions:{},selectedVersion:null,loadedVersion:null,errorStatus:null,isCopied:!1,copyError:!1},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.getVersions(),this.getCurrentVersion()},n.componentDidUpdate=function(){this.getQueryParamOverride()},n.getEnv=function(){var e=null;if("undefined"!=typeof window&&window.location&&window.location.host)switch(e=(e=window.location.host.split(".")[1]).toUpperCase()){case"ZILLOW":e="PROD"}return e},n.getArtifactString=function(){var e=this.getEnv();return e?e+"---home-details-content":null},n.getVersions=function(){return new Promise((function(e,t){var n,r,a,i;if(!(n=this.getArtifactString()))return this.setErrorStatus("unable to get artifact string from url for version selector"),l.call(this);var o=(function(){try{return l.call(this)}catch(e){return t(e)}}).bind(this),s=(function(e){try{return this.setErrorStatus("unable to retrieve artifacts"),o()}catch(e){return t(e)}}).bind(this);try{return Promise.resolve(v.a.get("/admin/versions/distributions/"+n)).then((function(e){try{return r=e.data,a=void 0===r?{}:r,(i=g()(a,"artifacts."+n+".versions",null))?this.setState({versions:i}):this.setErrorStatus("Artifact: "+n+" did not exist in returned versions object"),o()}catch(e){return s(e)}}).bind(this),s)}catch(e){s(e)}function l(){return e()}}).bind(this))},n.getCurrentVersion=function(){return new Promise((function(e,t){var n,r,a,i,o;n=this.props.zguid;var s=function(){try{return e()}catch(e){return t(e)}},l=(function(e){try{return this.setErrorStatus("Unable to retrieve current version for zguid: "+n),s()}catch(e){return t(e)}}).bind(this);try{var c=function(){return s()};return(r=this.getArtifactString())?Promise.resolve(v.a.get("/admin/versions/",{params:{key:n}})).then((function(e){try{return a=e.data,i=void 0===a?{}:a,(o=g()(i,"artifacts."+r+".versionName",null))&&this.setState({loadedVersion:o}),c.call(this)}catch(e){return l(e)}}).bind(this),l):c.call(this)}catch(e){l(e)}}).bind(this))},n.getQueryParamOverride=function(){var e=Object(d.O)(I),t=this.state,n=t.versions,r=t.loadedVersion;if(e&&n){var a=new RegExp(e,"i"),i=Object.keys(n),o=g()(i.filter((function(e){return a.test(e)})),"0",null);o&&o!==r&&this.setState({loadedVersion:o})}},n.setErrorStatus=function(e){var t=this;this.setState({errorStatus:e}),setTimeout((function(){t.setState({errorStatus:null})}),1e4)},n.refreshPage=function(){window.location.reload()},n.render=function(){var e=this,t=this.state,n=t.versions,r=t.selectedVersion,i=t.errorStatus,o=t.loadedVersion,s=t.isCopied,l=t.copyError;return a.a.createElement(O,{padding:"sm"},a.a.createElement(T,null,"Edit current version"),a.a.createElement("div",null,"Current version:"," ",a.a.createElement("span",null,o||"Error retrieving selected version")),a.a.createElement("div",null,"Selected version:"," ",a.a.createElement("span",null,r&&r!==o?r:"No version selected to load")),a.a.createElement(w,{onSelect:this.handleSelect,data:n,popOverTitle:"Home Details Content Versions"}),a.a.createElement(u.ButtonGroup,{spacingTop:"sm"},a.a.createElement(u.Button,{buttonType:"primary",onClick:this.refreshPage,disabled:!r||r===o},"Load Override"),a.a.createElement(u.Button,{buttonType:"caution",onClick:this.deleteOverride},"Undo Override")),a.a.createElement(u.ButtonGroup,{spacingTop:"xs",spacingBottom:"xs"},a.a.createElement(u.Button,{buttonType:"secondary",disabled:!o,onClick:function(){e.copyVersion(o)}},"Get current version link"),a.a.createElement(u.Button,{buttonType:"secondary",onClick:function(){e.copyVersion(r)},disabled:!r||r===o},"Get selected version link")),s&&a.a.createElement("div",null,"Link to version successfully copied"),l&&a.a.createElement("div",null,"Link to version failed, this copier only works on chrome and firefox"),i&&a.a.createElement(P,null,i))},t}(a.a.Component);V.propTypes={};var A=Object(m.connect)((function(e){return{zguid:e.appState.keystoneData._guid}}),{})(V);function j(e){var t=e.zpid;if(!t)return null;var n={p:"iphone",fromApp:!0},r=b.a.encode(n);n.zpid=t;for(var i=b.a.encode(n),o={"Home details page":"homedetail/MobileAppHomeDetailsServicePage.htm?"+r+"#zpid="+t,"Contact agent":"mobile/contact-agent?"+i,"Schedule tour":"mobile/schedule-tour?"+i,"Start an offer":"mobile/start-offer?"+i},s=[],l=0,c=Object.entries(o);l<c.length;l++){var d=Object(h.a)(c[l],2),m=d[0],p=d[1],v=window.location.origin+"/"+p;s.push(a.a.createElement("li",null,a.a.createElement(u.Text,null,a.a.createElement("a",{href:v,target:"_blank"},m))))}return a.a.createElement(u.Spacer,{spacingTop:"sm"},a.a.createElement(u.Collapsible,{defaultCollapsed:!0,children:function(e,t){return a.a.createElement(a.a.Fragment,null,a.a.createElement(u.Button,{onClick:t,spacingBottom:"xs"},e?"Show mobile web views":"Hide mobile web views"),e?null:a.a.createElement(u.Card,{cardType:"secondary"},a.a.createElement("ul",null,s)))}}))}function x(){var e=Object(s.a)(["\n    background: ",";\n    padding: ",";\n"]);return x=function(){return e},e}j.propTypes={};var D=function(){return n.e(54).then(n.bind(null,1904))};function B(e){var t=e.zuid;return a.a.createElement("a",{target:"_blank",href:"/user/Impersonate.htm?zuid="+t,title:"Impersonate"},t)}B.propTypes={};var L=c.default.div.withConfig({componentId:"sc-158zrld-4"})(x(),(function(e){return e.theme.foundation.colors.gray500}),(function(e){return e.theme.foundation.spacing.sm()})),G=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={isShowingGdpEditor:!1},t}Object(o.a)(t,e);var n=t.prototype;return n.onClearLocalStorage=function(){window.localStorage.removeItem(d.s),window.location.reload()},n.render=function(){var e=this,t=this.props.viewer||{},n=t.isAdmin,r=t.zuid;if(!n)return null;var o=this.props.property||{},s=o.zpid,l=o.listingSource,c=o.listingAccount,m=o.ownerAccount,p=o.lfaViewPropertyPageUrl,v=o.listingOwnerConfigIDs,f=o.postingPresentationTypes,g=c||{},h=g.zuid,E=g.email,b=(m||{}).zuid;return a.a.createElement(a.a.Fragment,null,a.a.createElement(L,null,a.a.createElement(u.ButtonGroup,null,a.a.createElement(u.Button,{size:"sm",onClick:function(){return e.setState({isShowingGdpEditor:!0})}},"Edit GDP Response"),"undefined"!=typeof window&&window.localStorage.getItem(d.s)&&a.a.createElement(u.Button,{size:"sm",buttonType:"caution",onClick:this.onClearLocalStorage},"Clear Override")),a.a.createElement(A,null),a.a.createElement(j,{zpid:s})),this.state.isShowingGdpEditor&&a.a.createElement(i.default,{loader:D,renderPlaceholder:!1,client:this.props.client,onClose:function(){return e.setState({isShowingGdpEditor:!1})}}),a.a.createElement("div",{className:"zsg-subfooter"},a.a.createElement("style",null,"\n                .debug-attr {\n                    width: 65%;\n                    vertical-align: top;\n                    display: inline-block;\n                }\n\n                .debug-attr-value {\n                    width: 35%;\n                    display: inline-block;\n                    word-wrap: break-word;\n                }\n\n                .debug-attr-value-supplement{\n                    width:70%;\n                    margin-left:3px;\n                    font-size:10px;\n                }\n\n                .hdp-debug-info{\n                    padding: 10px;\n                    overflow: hidden;\n                }\n                "),a.a.createElement("div",{className:"zsg-subfooter-content hdp-debug-info"},a.a.createElement("h2",null,"HDP Debug Info"),a.a.createElement("div",{className:"zsg-g"},a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Listing source:")),a.a.createElement("div",{className:"debug-attr-value"},a.a.createElement("span",null,l),a.a.createElement("div",{className:"debug-attr-value debug-attr-value-supplement"},a.a.createElement("a",{href:p,target:"_blank"},"(View property in LFA)")))),a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Posting Information:")),a.a.createElement("div",{className:"debug-attr-value"},a.a.createElement("a",{target:"_blank",href:"/ecui/ViewPostingData.htm?zpid="+s},"View Posting Data"))),a.a.createElement("div",{id:"hdp-debug-info-listing-owner",className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Listing owner:")),a.a.createElement("div",{className:"debug-attr-value"},h?a.a.createElement(B,{zuid:h}):"none")),a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Listing owner email:")),a.a.createElement("div",{className:"debug-attr-value"},E||"none")),a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Property owner:")),a.a.createElement("div",{className:"debug-attr-value"},b?a.a.createElement(B,{zuid:b}):"none")),a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Effective user:")),a.a.createElement("div",{className:"debug-attr-value"},a.a.createElement("span",null,r||"none"))),a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Contact Emails:")),a.a.createElement("div",{className:"debug-attr-value"},a.a.createElement("a",{target:"_blank",href:"/contact/ViewContactTarget.htm?zpid="+s},"View Contact Emails"))),a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Listing Owner Config IDs:")),a.a.createElement("div",{className:"debug-attr-value"},a.a.createElement("span",null,v||"none"))),a.a.createElement("div",{className:"zsg-lg-1-2 zsg-sm-1-1"},a.a.createElement("div",{className:"debug-attr"},a.a.createElement("h4",null,"Posting Presentation Types:")),a.a.createElement("div",{className:"debug-attr-value"},a.a.createElement("span",null,f?"["+f.join(", ")+"]":"none")))))))},t}(a.a.Component);G.propTypes={},t.default=G}});